# การทดลองที่ ๗ เรื่อง การเขียนโปรแกรมเพื่อรันบนไมโครคอนโทรเลอร์

## วัตถุประสงค์
1. เพื่อศึกษาการเขียนโปรแกรมประยุกต์จากการเรียนรู้การทดลองที่ 1-6
2. เพื่อเขียนโปรแกรมรันบนไมโครคอนโทรเลอร์ด้วยตัวเอง
## อุปกรณ์ที่ใช้
1. ไมโครคอนโทรเลอร์
2. อุปกรณ์ USB to Serial
3. อแดปเตอร์ที่ต่อสายพอร์ท 0(สีขาว) กับ 2 (สีเหลือง)
4. หลอดไฟ LED
5. CPU
6. ตัวโปรแกรมที่เขียนขึ้นมาเอง(07_Lab7)
 
## ศึกษาข้อมูลเบื้องต้น
1. ตัวอย่าง src code ของการทดลองที่ 1-6 : https://github.com/choompol-boonmee/lab63b/tree/master/examples
2. src code ของโปรแกรมที่เขียนขึ้นมาเอง(07_Lab7) : https://github.com/Nongpim/lab63b/blob/main/07_Lab7

## วิธีการทำการทดลอง
1. เขียนโปรแกรมที่จะนำไปรันบนไมโครคอนโทรเลอร์(โปรแกรมที่7)แล้วตั้งชื่อไฟล์ว่า 07_Lab7 โดย src code จะอยู่ที่ https://github.com/Nongpim/lab63b/blob/main/07_Lab7
2. นำไมโครคอนโทรเลอร์ไปต่ออุปกรณ์ USB to Serial แล้วเปิด command prompt เพื่อเขียนโปรแกรมเข้าไปในไมโครคอนโทรเลอร์
3. พิมพ์คำสั่ง cd 07_Lab7 ในหน้า command prompt
    * 3.1 พิมพ์คำสั่ง vi src/main.cpp จะแสดงโค้ดของโปรแกรม ซึ่งประกอบไปด้วย 3 ส่วน
      * 3.1.1 ส่วนแรก : ส่วนประกาศตัวแปร
      
      * ![image](https://github.com/Nongpim/picture/blob/main/7.1%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88%E0%B9%86.jpg)

      * 3.1.2 ส่วนที่สอง : ส่วน Setup
      
      * ![image](https://github.com/Nongpim/picture/blob/main/7.2%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88.jpg)
      
      * 3.1.3 ส่วนที่สาม : ส่วน Loop
      
      * ![image](https://github.com/Nongpim/picture/blob/main/7.3%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88.jpg)
      
        * และ จาก src code ข้างต้น แสดงให้เห็นว่า ESP 01 มีไวไฟในตัวเอง โดยจะกำหนดชื่อ wifi และ password ก่อน ที่จะปล่อยให้เครื่องอื่น connect และมีการสร้าง IPAdress,gateway,subnet และเตรียมเว็บเซิร์ฟเวอร์
4. อัปโหลดโปรแกรม 07_Lab7 โดยพิมพ์คำสั่ง pio run -t upload
    * 4.1 ในขณะที่รันเพื่อให้ไมโครคอนโทรเลอร์รับโปรแกรมใหม่เข้าไป เราจะต้องกดปุ่มให้โหลด(ปุ่มสีดำ) แล้วกดปุ่มreset(ปุ่มสีแดง) เมื่อโปรแกรมโหลดเข้าไปในคอมพิวเตอร์ตัวจิ๋วนี้แล้ว
5. เมื่อโปรแกรมโหลดเสร็จแล้วจะขึ้นคำว่า SUCCESS 
6. พิมพ์คำสั่ง (pio device monitor) เพื่อดูผลลัพธ์ที่แสดงผลใน monitor
7. ลองใช้โทรศัพท์มือถือ หรือคอมพิวเตอร์ ค้นหาไวไฟที่สร้าง 
8. เชื่อมต่อไวไฟ และสังเกตหลอดไฟ LED
   
## การบันทึกผลการทดลอง
จากใช้คำสั่ง pio device monitor จะทำให้เราทราบว่า
1. ผลลัพธ์จะแสดงผลในหน้าจอ monitor โดยขึ้นคำว่า ver started และตรวจสอบผลลัพธ์จากการสร้างไวไฟด้วยการหาชื่อไวไฟด้วยโทรศัพท์มือถือ ซึ่งจากการค้นหาไวไฟในโทรศัพท์มือถือ ทำให้เราพบไวไฟที่เราสร้างจากการเขียนโปรแกรม(Futuro_6.5G)
    * 1.1 ถ้าเราเชื่อมไวไฟ (Futuro_6.5G) ได้ -> หลอดไฟ LED จะสว่าง ที่พอร์ต 2 ค่าจะ HIGH 
    * 1.2 ถ้าเราเชื่อมไวไฟ(Futuro_6.5G) ไม่ได้ -> หลอดไฟ LED จะดับ ที่พอร์ต 2 ค่าจะ LOW

## อภิปรายผลการทดลอง
จากการทดลองนี้ เป็นการเขียนโปรแกรมสร้างไวไฟและเชื่อมต่อไวไฟโดยใช้หลอดไฟ LED เข้ามาเช็คการเชื่อมต่อของไวไฟที่เราสร้างไวไฟขึ้นมาเอง โดยโปรแกรมนี้ผู้ทำการทดลองได้เขียนโปรแกรมขึ้นมาด้วยตนเองจากการศึกษาการทำแลป 1-6 ซึ่งในสถานการณ์โควิด ผู้ทำการทดลองไม่มีอุปกรณ์จริงในการทำ ทำให้การเขียนโปรแกรมด้วยตนเองและการบันทึกผลแลปนี้อาจเกิดข้อผิดพลาดได้เมื่อนำมาปฏิบัติจริง

## คำถามหลังการทดลอง
1. ประโยชน์ของการประยุกต์การนำหลอดไฟ LED มาใช้กับการเชื่อมต่อไวไฟมีอะไรบ้าง
* ตอบ ทำให้เรามั่นใจในการเชื่อมไวไฟมากยิ่งขึ้น
