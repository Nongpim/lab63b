# การทดลองที่ ๑ เรื่อง การเขียนโปรแกรมเพื่อรันบนไมโครคอนโทรเลอร์

## วัตถุประสงค์
1. เพื่อศึกษาวิธีการใช้ Platformio เบื้องต้น
2. เพื่อศึกษาการเขียนโปรแกรมเข้าไปในไมโครคอนโทรเลอร์
3. เพื่อศึกษาการใช้คำสั่งพื้นฐานของไมโครคอนโทรเลอร์

## อุปกรณ์ที่ใช้
1. ไมโครคอนโทรเลอร์
2. อุปกรณ์ USB to Serial
3. CPU
4. เสาอากาศสำหรับไวไฟ

## ศึกษาข้อมูลเบื้องต้น
1. 01 run example 1 : https://youtu.be/NLIUsWLEpmg
2. ความรู้เกี่ยวกับ ESP-01 microcontroller : https://docs.platformio.org/en/latest/boards/espressif8266/esp01_1m.html
3. ความรู้เกี่ยวกับ platformio : https://platformio.org/
4. ความรู้เกี่ยวกับ iotset1 : https://youtu.be/9aF0upI9Gic

## วิธีการทำการทดลอง
1. นำไมโครคอนโทรเลอร์ไปต่ออุปกรณ์ USB to Serial แล้วเปิด command prompt เพื่อเขียนโปรแกรมเข้าไปในไมโครคอนโทรเลอร์

2. ดูตัวอย่างโปรแกรมที่จะเขียนในโฟลเดอร์ pattani 
   * 2.1 พิมพ์คำสั่ง cd pattani เพื่อที่จะเข้าไปยังโฟลเดอร์ 
   * 2.2 โฟลเดอร์จะแสดงตัวอย่างโปรแกรม 9 โปรแกรม
      * 2.2.1 ซึ่งในการทดลองนี้จะให้ใช้โปรแกรมตัวอย่างที่1 พิมพ์คำสั่ง cd 01_Serial-Monitor
      * 2.2.2 พิมพ์คำสั่ง vi src/main.cpp จะแสดงโค้ดของโปรแกรม โดยโปรแกรมนี้ มี 15 บรรทัด ซึ่งประกอบไปด้วย 2 ส่วน
3. อัปโหลดโปรแกรม 01_Serial-Monitor โดยพิมพ์คำสั่ง pio run -t upload
   * 3.1 ในขณะที่รันเพื่อให้ไมโครคอนโทรเลอร์รับโปรแกรมใหม่เข้าไป เราจะต้องกดปุ่มให้โหลด(ปุ่มสีดำ) แล้วกดปุ่มreset(ปุ่มสีแดง) เมื่อโปรแกรมโหลดเข้าไปในคอมพิวเตอร์ตัวจิ๋วนี้แล้ว 
4. เมื่อโปรแกรมโหลดเสร็จแล้วจะขึ้นคำว่า SUCCESS ซึ่งต่อไปเราจะใช้คำสั่ง (pio device monitor) แล้วดูผลลัพธ์ที่แสดงผลใน monitor
* (พร้อมภาพประกอบ)

## การบันทึกผลการทดลอง
จากการใช้คำสั่ง platformio.ini จะทำให้เราทราบข้อมูลดังนี้
1. platform ที่ใช้เป็น platform ของ espressif8266
2. board ที่ใช้ชื่อ esp01_1m
3. โปรแกรมนี้ใช้วิธีการเขียนแบบ arduino
4. port ที่ใช้ในการทดลอง ถ้าใช้ของ windows ชื่อ portจะขึ้นว่า COM3
และหลังจากใช้คำสั่ง pio device monitor จะทำให้เราทราบว่า
1. ผลลัพธ์จะแสดงผลในหน้าจอ monitor ซึ่งจะเห็นได้ว่า ตัวแปร count ที่เริ่มตั้งแต่ 0 จะถูก ingrement 1,2,3,... เรื่อยไปและจะแสดงผลทุกๆ 1 วินาที 
2. เมื่อเราลองกดปุ่ม reset(ปุ่มสีแดง) ไมโครคอนโทรเลอร์จะ reset ตัวเองแล้วเริ่มนับ 1 ใหม่
* (พร้อมตัวอย่าง)

## อภิปรายผลการทดลอง
จากการใช้คำสั่ง vi src/main.cpp ทำให้เราทราบว่าโปรแกรมนี้แบ่งออกเป็น 2 ส่วน คือ
1. ส่วน Setup จะรันครั้งเดียว โดยจะ Setup Serial ที่ความเร็ว 115200 
2. ส่วน Loop จะรันหลายๆครั้งตลอดไป ซึ่งจะเพิ่มตัวแปร count(cnt) เพิ่มขึ้นเรื่อยๆ โดยที่ให้แสดงผลตัวแปรcountออกมา โดยหน่วงเวลา 1 วินาที หรือ 1000 ms

## คำถามหลังการทดลอง
1. กรณีที่เราเขียนโปรแกรมใส่ในไมโครคอนโทรเลอร์แล้ว เราจะสามารถเขียนโปรแกรมใหม่เข้าไปในตัวไมโครคอนโทรเลอร์ได้อีกหรือไม่
* ตอบ ได้ เนื่องจากไมโครคอนโทรลเลอร์สามารถปรับปรุงการทำงานได้ตามคำสั่งที่เราต้องการ
